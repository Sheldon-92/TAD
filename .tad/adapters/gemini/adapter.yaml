# Gemini CLI Adapter Configuration
# TAD v2.1 - Secondary Platform (Google)

adapter:
  platform: "gemini-cli"
  version: "1.0"
  status: "secondary"

# ============================================
# Platform Identification
# ============================================
identification:
  name: "Gemini CLI"
  id: "gemini"
  vendor: "Google"
  documentation: "https://geminicli.com/docs/"

# ============================================
# Detection Strategy
# ============================================
detection:
  command_check:
    command: "gemini --version"
    success_pattern: "gemini"

  directory_check:
    path: "$HOME/.gemini"
    required_files: []

  match_strategy: "any"

# ============================================
# Configuration Paths
# ============================================
paths:
  user_config: "$HOME/.gemini/settings.json"
  project_config: ".gemini/settings.json"
  commands_dir: ".gemini/commands"  # Project-level
  user_commands_dir: "$HOME/.gemini/commands"
  project_instructions: "GEMINI.md"
  user_instructions: "$HOME/.gemini/GEMINI.md"

# ============================================
# Skill Execution
# ============================================
skill_execution:
  mode: "self-check"
  description: "Read SKILL.md and execute checklist manually"

  execution_template: |
    1. Read skill definition: .tad/skills/{skill_id}/SKILL.md
    2. Parse checklist sections by priority (P0, P1, P2, P3)
    3. For each checklist item:
       a. Evaluate against target files
       b. Record pass/fail
       c. Note any issues found
    4. Apply pass criteria:
       - P0: All must pass
       - P1: Based on skill's max_failures
       - P2/P3: Informational
    5. Generate evidence file: .tad/evidence/reviews/{date}-{skill_id}-{task}.md
    6. Return: {passed, issues[], evidence_path}

# ============================================
# Command Format
# ============================================
commands:
  format: "toml"
  extension: ".toml"
  location: "project"  # .gemini/commands/

  conversion:
    from: "claude"
    transformations:
      - action: "convert_to_toml"
      - action: "extract_description"
        source: "first_paragraph"
      - action: "convert_prompt"
        template: |
          description = "{description}"

          prompt = """
          {prompt_content}

          ## TAD Skill Reference
          @{.tad/skills/README.md}

          ## Evidence Output
          Generate evidence at: .tad/evidence/reviews/
          """

  # TOML structure template
  toml_template: |
    description = "{one_line_description}"

    prompt = """
    {full_prompt_content}

    {{args}}
    """

# ============================================
# Project Instructions
# ============================================
project_instructions:
  filename: "GEMINI.md"

  generation:
    source: "CLAUDE.md"
    method: "convert"
    transformations:
      - "Remove Claude-specific references"
      - "Adapt skill execution instructions"
      - "Update command references"
      - "Add Gemini-specific /memory commands"
      - "Keep core TAD rules intact"

# ============================================
# Evidence Collection
# ============================================
evidence:
  directory: ".tad/evidence/reviews"
  naming: "{date}-{skill_id}-{task}.md"
  retention_days: 30

# ============================================
# Features
# ============================================
features:
  native_subagents: false
  custom_commands: true
  memory_commands: true
  gemini_md: true
  hierarchical_context: true

# ============================================
# TAD Integration
# ============================================
tad_integration:
  full_support: false
  degraded_mode: true

  # Available commands
  commands:
    - "/tad-alex"
    - "/tad-blake"
    - "/tad-gate"
    - "/tad-init"

  # Ralph Loop - self-check mode
  ralph_loop:
    supported: true
    layer1_execution: "native"
    layer2_execution: "self-check"

  # Limitations
  limitations:
    - "No native subagents - uses self-check"
    - "TOML format requires conversion"
    - "Some advanced TAD features may not work"

# ============================================
# Gemini-Specific Settings
# ============================================
gemini_specific:
  toml_syntax:
    required: ["prompt"]
    optional: ["description"]

  placeholder_syntax:
    arguments: "{{args}}"
    file_content: "@{path/to/file}"
    shell_output: "!{command}"
    directory_listing: "@{path/to/dir}"

  namespacing:
    method: "directory"
    example: "commands/tad/alex.toml -> /tad:alex"

  memory_commands:
    show: "/memory show"
    refresh: "/memory refresh"
    add: "/memory add <text>"

  context_hierarchy:
    - "$HOME/.gemini/GEMINI.md"
    - "project_root/GEMINI.md"
    - "current_dir/GEMINI.md"
    - "subdirectories/GEMINI.md"

# ============================================
# Command Conversion Example
# ============================================
conversion_example:
  source: |
    # TAD Alex Command

    Activate Alex (Solution Lead) for requirements analysis and design.

    ## Instructions
    1. Analyze requirements
    2. Create handoff document

  target: |
    description = "Activate TAD Alex (Solution Lead) for requirements analysis and design"

    prompt = """
    Activate Alex (Solution Lead) for requirements analysis and design.

    ## Instructions
    1. Analyze requirements
    2. Create handoff document

    ## Context
    @{GEMINI.md}
    @{.tad/skills/README.md}

    ## Arguments
    {{args}}
    """
